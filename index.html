<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Digital Healthcare System - Admin</title>

  <style>
    /* ‚úÖ Center White Card Form (Matches Screenshot) */
.form-card {
  width: 60%;
  margin: 30px auto;
  background: #ffffff;
  padding: 35px;
  border-radius: 10px;
  box-shadow: 0 5px 20px rgba(0,0,0,0.08);
}

/* ‚úÖ Headings inside card */
.form-card h3 {
  font-size: 22px;
  margin-bottom: 20px;
  font-weight: 600;
}

/* ‚úÖ Labels */
.form-card label {
  font-weight: 500;
  margin-bottom: 6px;
  display: block;
}

/* ‚úÖ Inputs */
.form-card input,
.form-card select,
.form-card textarea {
  width: 100%;
  padding: 14px;
  font-size: 15px;
  border: 1px solid #dcdcdc;
  border-radius: 6px;
  margin-bottom: 18px;
}

/* ‚úÖ Textarea height */
.form-card textarea {
  min-height: 120px;
  resize: vertical;
}

/* ‚úÖ Submit button */
.form-card .btn {
  width: 100%;
  padding: 14px;
  background: linear-gradient(135deg,#667eea,#764ba2);
  border: none;
  color: #fff;
  border-radius: 6px;
  font-size: 16px;
  cursor: pointer;
  font-weight: 600;
}

.form-card .btn:hover {
  opacity: 0.9;
}

    .form-container {
  background: #fff;
  padding: 2rem;
  border-radius: 10px;
  box-shadow: 0 4px 6px rgba(0,0,0,.1);
  max-width: 600px;
  margin: 0 auto;
}

.form-group {
  margin-bottom: 1.2rem;
}

.form-group label {
  display:block;
  margin-bottom:.5rem;
  color:#555;
  font-weight:500;
}

.form-group input,
.form-group select,
.form-group textarea {
  width:100%;
  padding:.75rem;
  border:1px solid #ddd;
  border-radius:6px;
  font-size:1rem;
}

.form-group textarea {
  min-height:110px;
}

    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;line-height:1.6;color:#333}
    header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:1rem 0;box-shadow:0 2px 5px rgba(0,0,0,.1)}
    nav{display:flex;justify-content:space-between;align-items:center;max-width:1200px;margin:0 auto;padding:0 2rem}
    .logo{font-size:1.5rem;font-weight:bold}
    .nav-links{display:flex;gap:2rem;list-style:none;align-items:center}
    .nav-links a{color:#fff;text-decoration:none;transition:opacity .3s}
    .nav-links a:hover{opacity:.8}
    .btn-logout{background:rgba(255,255,255,.2);color:#fff;padding:.5rem 1.5rem;border:1px solid #fff;border-radius:5px;cursor:pointer}
    .btn-logout:hover{background:rgba(255,255,255,.3)}

    .hero{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:4rem 2rem;text-align:center}

    .container{max-width:1200px;margin:2rem auto;padding:0 2rem}

    .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:2rem;margin-top:2rem}
    .card{background:#fff;border-radius:10px;padding:2rem;box-shadow:0 4px 6px rgba(0,0,0,.1)}

    table{width:100%;border-collapse:collapse;background:#fff;border-radius:10px;overflow:hidden}
    th,td{padding:1rem;border-bottom:1px solid #eee}
    th{background:#667eea;color:#fff}

    .hidden{display:none}
    .tabs{display:flex;gap:1rem;margin-bottom:2rem;border-bottom:2px solid #eee}
    .tab{padding:1rem 2rem;cursor:pointer;background:none;border:none}
    .tab.active{color:#667eea;border-bottom:3px solid #667eea}

    .alert{padding:1rem;border-radius:6px;margin:.75rem 0}
    .alert-success{background:#d4edda}
    .alert-error{background:#f8d7da}
  </style>
</head>
<body>

<header>
  <nav>
    <div class="logo">üè• Digital Healthcare System - Admin</div>
    <ul class="nav-links">
      <li><a href="#" onclick="showSection('home')">Home</a></li>
      <li><a href="#" onclick="showSection('appointments')">Appointments</a></li>
      <li><a href="#" onclick="showSection('patients')">Patients</a></li>
      <li><a href="#" onclick="showSection('doctors')">Doctors</a></li>
      <li><span id="adminName">Admin</span></li>
      <li><button class="btn-logout" onclick="logout()">Logout</button></li>
    </ul>
  </nav>
</header>

<div id="home" class="hero section-content">
  <h1>Welcome to Digital Healthcare System</h1>
  <p>Admin Dashboard - Manage Everything</p>
</div>

<!-- ‚úÖ HOME CARDS -->
<div class="container section-content" id="home-content">
  <div class="cards">
    <div class="card"><h3>Total Doctors</h3><p id="homeTotalDoctors">0</p></div>
    <div class="card"><h3>Total Patients</h3><p id="homeTotalPatients">0</p></div>
    <div class="card"><h3>Total Appointments</h3><p id="homeTotalAppointments">0</p></div>
    <div class="card"><h3>Today's Appointments</h3><p id="homeTodaysAppointments">0</p></div>
    <div class="card"><h3>Completed Appointments</h3><p id="homeCompletedAppointments">0</p></div>
  </div>
</div>

<!-- ‚úÖ OTHER SECTIONS START -->
<div class="container">

  <!-- Appointments -->
  <div id="appointments-content" class="section-content hidden">
    <h2>Appointment Management</h2>

    <div class="tabs">
      <button class="tab active" onclick="showTab('book-appointment')">Book Appointment</button>
      <button class="tab" onclick="showTab('view-appointments')">View Appointments</button>
    </div>

    <div id="book-appointment" class="tab-content">
      <div class="form-container">
  <h3 style="margin-bottom:1rem;">Book New Appointment</h3>
  <div id="appointment-alert"></div>

  <form id="appointmentForm">

    <div class="form-group">
      <label>Patient Name</label>
      <input type="text" name="patient_name" required />
    </div>

    <div class="form-group">
      <label>Patient Email</label>
      <input type="email" name="patient_email" required />
    </div>

    <div class="form-group">
      <label>Doctor</label>
      <select name="doctor_id" id="doctorSelect" required>
        <option value="">Select Doctor</option>
      </select>
    </div>

    <div class="form-group">
      <label>Appointment Date</label>
      <input type="date" name="appointment_date" id="appointmentDate" required />
    </div>

    <div class="form-group">
      <label>Time Slot (30 min)</label>
      <select id="timeSlotSelect" required>
        <option value="">Select Time Slot</option>
      </select>
    </div>

    <div class="form-group">
      <label>Reason</label>
      <textarea name="reason" required placeholder="Please describe your symptoms or reason for visit..."></textarea>
    </div>

    <button type="submit" class="btn">Book Appointment</button>

  </form>
</div>

    </div>

    <div id="view-appointments" class="tab-content hidden">
      <h3>All Appointments</h3>
      <table>
        <thead>
        <tr><th>ID</th><th>Patient</th><th>Email</th><th>Doctor</th><th>Date</th><th>Time</th><th>Status</th></tr>
        </thead>
        <tbody id="appointmentsBody">
        <tr><td colspan="7">Loading...</td></tr>
        </tbody>
      </table>
    </div>

  </div>

  <!-- Patients -->
  <div id="patients-content" class="section-content hidden">
    <h2>Patient Management</h2>
    <div class="tabs">
      <button class="tab active" onclick="showTab('add-patient')">Add Patient</button>
      <button class="tab" onclick="showTab('view-patients')">View Patients</button>
    </div>

    <div id="add-patient" class="tab-content">
  <div class="form-card">

    <h3>Register New Patient</h3>
    <div id="patient-alert"></div>

    <form id="patientForm">

      <label>Full Name</label>
      <input type="text" name="name" required>

      <label>Email</label>
      <input type="email" name="email" required>

      <label>Phone</label>
      <input type="text" name="phone" required>

      <label>Date of Birth</label>
      <input type="date" name="dob" required>

      <label>Gender</label>
      <select name="gender" required>
        <option value="">Select Gender</option>
        <option>Male</option>
        <option>Female</option>
        <option>Other</option>
      </select>

      <label>Address</label>
      <textarea name="address"></textarea>

      <button class="btn">Register Patient</button>

    </form>

  </div>
</div>


    <div id="view-patients" class="tab-content hidden">
      <h3>All Patients</h3>
      <table>
        <thead>
        <tr><th>ID</th><th>Name</th><th>Email</th><th>Phone</th><th>Gender</th><th>DOB</th></tr>
        </thead>
        <tbody id="patientsBody">
        <tr><td colspan="6">Loading...</td></tr>
        </tbody>
      </table>
    </div>

  </div>

  <!-- Doctors -->
  <div id="doctors-content" class="section-content hidden">
    <h2>Doctor Management</h2>

    <div class="tabs">
      <button class="tab active" onclick="showTab('add-doctor')">Add Doctor</button>
      <button class="tab" onclick="showTab('view-doctors')">View Doctors</button>
    </div>

    <div id="add-doctor" class="tab-content">
  <div class="form-card">

    <h3>Add New Doctor</h3>
    <div id="doctor-alert"></div>

    <form id="doctorForm">

      <label>Full Name</label>
      <input type="text" name="name" required>

      <label>Specialization</label>
      <input type="text" name="specialization" required>

      <label>Email</label>
      <input type="email" name="email" required>

      <label>Phone</label>
      <input type="text" name="phone" required>

      <label>Experience (Years)</label>
      <input type="number" name="experience" required>

      <button class="btn">Add Doctor</button>

    </form>

  </div>
</div>


    <div id="view-doctors" class="tab-content hidden">
      <h3>All Doctors</h3>
      <table>
        <thead>
        <tr><th>ID</th><th>Name</th><th>Specialization</th><th>Email</th><th>Phone</th><th>Experience</th></tr>
        </thead>
        <tbody id="doctorsBody">
        <tr><td colspan="6">Loading...</td></tr>
        </tbody>
      </table>
    </div>

  </div>

</div>

<footer><p>&copy; 2024 Digital Healthcare System</p></footer>

<script>
const API_URL = "http://localhost:3000/api";

let currentUser = null;

window.onload = () => {
  const u = localStorage.getItem("user");
  if (!u) return location.href = "login.html";

  currentUser = JSON.parse(u);
  document.getElementById("adminName").textContent = currentUser.name;

  showSection("home"); // ‚úÖ load home by default
};

function logout() {
  localStorage.removeItem("user");
  location.href = "login.html";
}

function showSection(section) {
  document.querySelectorAll(".section-content").forEach(s => s.classList.add("hidden"));
  document.getElementById("home-content").classList.add("hidden");

  if (section === "home") {
    document.getElementById("home").classList.remove("hidden");
    document.getElementById("home-content").classList.remove("hidden");
    loadHomeData();
    return;
  }

  document.getElementById(section + "-content").classList.remove("hidden");

  if (section === "appointments") loadDoctorsForSelect();
  if (section === "patients") loadPatients();
  if (section === "doctors") loadDoctors();
}

function showTab(tabName) {
  const parent = event.target.closest(".section-content");

  parent.querySelectorAll(".tab-content").forEach(t => t.classList.add("hidden"));
  parent.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));

  document.getElementById(tabName).classList.remove("hidden");
  event.target.classList.add("active");

  if (tabName === "view-appointments") loadAppointments();
  if (tabName === "view-patients") loadPatients();
  if (tabName === "view-doctors") loadDoctors();
}

/* -----------------------------
    ‚úÖ HOME DASHBOARD DATA
----------------------------- */
async function loadHomeData() {
  try {
    const [aRes, dRes, pRes] = await Promise.all([
      fetch(`${API_URL}/appointments`),
      fetch(`${API_URL}/doctors`),
      fetch(`${API_URL}/patients`)
    ]);

    const appointments = await aRes.json();
    const doctors = await dRes.json();
    const patients = await pRes.json();

    document.getElementById("homeTotalDoctors").textContent = doctors.length;
    document.getElementById("homeTotalPatients").textContent = patients.length;
    document.getElementById("homeTotalAppointments").textContent = appointments.length;

    const today = new Date().toISOString().split("T")[0];

    document.getElementById("homeTodaysAppointments").textContent =
      appointments.filter(a => a.appointment_date === today).length;

    document.getElementById("homeCompletedAppointments").textContent =
      appointments.filter(a => a.status === "Completed").length;

  } catch (err) {
    console.error("Dashboard Load Error", err);
  }
}

/* -----------------------------
    ‚úÖ LOAD LISTS (Doctors / Patients / Appts)
----------------------------- */

async function loadDoctorsForSelect() {
  const res = await fetch(`${API_URL}/doctors`);
  const list = await res.json();
  const sel = document.getElementById("doctorSelect");

  sel.innerHTML = "<option value=''>Select Doctor</option>" +
    list.map(d => `<option value="${d.id}">${d.name} (${d.specialization})</option>`).join("");
}

async function loadDoctors() {
  const res = await fetch(`${API_URL}/doctors`);
  const list = await res.json();
  const tbody = document.getElementById("doctorsBody");

  tbody.innerHTML = list.map(d => `
    <tr><td>${d.id}</td><td>${d.name}</td><td>${d.specialization}</td><td>${d.email}</td><td>${d.phone}</td><td>${d.experience}</td></tr>
  `).join("");
}

async function loadPatients() {
  const res = await fetch(`${API_URL}/patients`);
  const list = await res.json();
  const tbody = document.getElementById("patientsBody");

  tbody.innerHTML = list.map(p => `
    <tr><td>${p.id}</td><td>${p.name}</td><td>${p.email}</td><td>${p.phone}</td><td>${p.gender}</td><td>${p.dob}</td></tr>
  `).join("");
}

async function loadAppointments() {
  const res = await fetch(`${API_URL}/appointments`);
  const list = await res.json();
  const tbody = document.getElementById("appointmentsBody");

  tbody.innerHTML = list.map(a => `
    <tr>
      <td>${a.id}</td>
      <td>${a.patient_name}</td>
      <td>${a.patient_email}</td>
      <td>${a.doctor_name || a.doctor_id}</td>
      <td>${a.appointment_date}</td>
      <td>${a.appointment_time}</td>
      <td>${a.status}</td>
    </tr>
  `).join("");
}
</script>

</body>
</html>
